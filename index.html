<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3학년 1반 | 추억 저장소</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="config.js" defer></script>
    <script src="app.js" defer></script>
</head>

<body>
    <nav class="glass-nav">
        <div class="logo" onclick="navigateTo('home')">
            <span>🏫 Class 3-1</span>
        </div>
        <ul class="nav-links">
            <li id="login-link" class="btn-signup">로그인</li>
        </ul>
    </nav>

    <main id="app-container">

        <!-- 1. 메인 홈 -->
        <section id="home" class="page active">
            <div class="hero-header">
                <h1>반가워요!<br>대전중학교 3학년 1반</h1>
                <p>기술을 좋아하는 우리들의 이야기가 모이는 공간</p>
            </div>

            <div class="menu-grid">
                <!-- 커뮤니티 -->
                <div class="menu-card" onclick="navigateTo('community')">
                    <div class="red-dot" id="dot-community"></div>
                    <div class="card-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path
                                d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z">
                            </path>
                        </svg>
                    </div>
                    <h3>커뮤니티</h3>
                    <p>우리반 수다방</p>
                </div>

                <!-- 학급 갤러리 -->
                <div class="menu-card" onclick="navigateTo('gallery')">
                    <div class="red-dot" id="dot-gallery"></div>
                    <div class="card-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                            <polyline points="21 15 16 10 5 21"></polyline>
                        </svg>
                    </div>
                    <h3>학급 갤러리</h3>
                    <p>우리의 추억들</p>
                </div>

                <!-- 오늘의 급식 (김 모락모락 ♨️ 스타일) -->
                <div class="menu-card" onclick="openLunchModal()">
                    <div class="card-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <!-- 그릇 -->
                            <path d="M4 14h16v2a6 6 0 0 1-6 6H10a6 6 0 0 1-6-6v-2z"></path>
                            <!-- 세로로 긴 김 3가닥 (♨️) -->
                            <path d="M8 3v6"></path>
                            <path d="M12 3v6"></path>
                            <path d="M16 3v6"></path>
                            <!-- 김 웨이브 효과 -->
                            <path d="M8 3c-1 2 1 4 0 6"></path>
                            <path d="M12 3c-1 2 1 4 0 6"></path>
                            <path d="M16 3c-1 2 1 4 0 6"></path>
                        </svg>
                    </div>
                    <h3>오늘의 급식</h3>
                    <p>맛있는 점심 메뉴</p>
                </div>

                <!-- 알림장 -->
                <div class="menu-card" onclick="navigateTo('notice')" id="notice-card">
                    <div class="red-dot" id="dot-notice"></div>
                    <div class="card-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                        </svg>
                    </div>
                    <h3>알림장</h3>
                    <p>선생님 말씀</p>
                </div>
            </div>
        </section>

        <!-- 2. 회원가입 / 로그인 -->
        <section id="auth" class="page">
            <div class="auth-container">
                <div id="login-view">
                    <h2 style="text-align:center; margin-bottom:20px;">로그인</h2>
                    <form id="login-form">
                        <div class="input-group">
                            <label>학번</label>
                            <input type="text" id="login-id" placeholder="예: 30101" maxlength="5">
                        </div>
                        <div class="input-group">
                            <label>비밀번호</label>
                            <input type="password" id="login-pw" placeholder="비밀번호">
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="remember-me">
                            <label for="remember-me">아이디/비밀번호 기억하기</label>
                        </div>
                        <button type="submit" id="btn-login" class="btn primary full-width">로그인</button>
                    </form>
                    <p style="text-align:center; margin-top:15px; font-size:0.9rem;">
                        아직 회원이 아니신가요? <a href="#" onclick="toggleAuthMode('signup')"
                            style="color:var(--primary)">회원가입</a>
                    </p>
                </div>

                <div id="signup-view" style="display:none;">
                    <h2 style="text-align:center; margin-bottom:20px;">회원가입 신청</h2>
                    <form id="signup-form">
                        <div class="input-group">
                            <label>이름</label>
                            <input type="text" id="signup-name" placeholder="본명 입력">
                        </div>
                        <div class="input-group">
                            <label>학번(4자리를 적어주세요. 예:1학년2반13번->1213)</label>
                            <input type="text" id="signup-id" placeholder="학번 4자리" maxlength="4">
                        </div>
                        <div class="input-group">
                            <label>비밀번호(8자리 이상 1개이상의 특수문자 포함)</label>
                            <input type="password" id="signup-pw" placeholder="비밀번호">
                        </div>
                        <button type="submit" id="btn-signup" class="btn primary full-width">가입 신청</button>
                    </form>
                    <p style="text-align:center; margin-top:15px; font-size:0.9rem;">
                        이미 계정이 있으신가요? <a href="#" onclick="toggleAuthMode('login')" style="color:var(--primary)">로그인</a>
                    </p>
                </div>
            </div>
        </section>

        <!-- 3. 커뮤니티 -->
        <section id="community" class="page">
            <div class="section-header">
                <h2>💬 커뮤니티</h2>
                <button id="btn-community-write" class="btn primary" style="display:none;">글쓰기</button>
            </div>
            <div id="community-list" class="community-list"></div>
            <div id="community-pagination" class="pagination"></div>
        </section>

        <!-- 4. 학급 갤러리 -->
        <section id="gallery" class="page">
            <div class="section-header">
                <h2>📷 학급 갤러리</h2>
                <button id="btn-gallery-write" class="btn primary" style="display:none;">사진 올리기</button>
            </div>
            <div id="gallery-grid" class="gallery-grid"></div>
            <!-- 무한 스크롤 트리거 (관찰 대상) -->
            <div id="gallery-loader" style="height: 20px; margin-top: 20px;"></div>
        </section>

        <!-- 5. 알림장 -->
        <section id="notice" class="page">
            <div class="section-header">
                <h2>📢 알림장</h2>
                <button id="btn-notice-write" class="btn primary" style="display:none;">글쓰기</button>
            </div>
            <div id="notice-container" class="community-list"></div>
            <div id="notice-pagination" class="pagination"></div>
        </section>

    </main>

    <!-- 모달들 -->

    <!-- A. 급식 모달 -->
    <div id="lunch-modal" class="modal">
        <div class="modal-content" style="text-align:center;">
            <span class="close-modal" onclick="closeModal('lunch-modal')">&times;</span>
            <h3 style="margin-bottom:20px; font-size:1.5rem;">🍱 오늘의 급식</h3>
            <div id="lunch-content" style="font-size:1.1rem; line-height:1.8; margin-bottom:20px;">
                🍚 오늘은 급식이 없습니다!
            </div>
        </div>
    </div>

    <!-- B. 커뮤니티 글쓰기 -->
    <div id="community-write-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('community-write-modal')">&times;</span>
            <h3 style="text-align:center; margin-bottom:20px;">📝 글쓰기</h3>
            <div>
                <div class="input-group">
                    <label>제목</label>
                    <input type="text" id="comm-title" placeholder="제목">
                    <div id="comm-title-byte" class="byte-counter">0 / 30</div>
                </div>
                <div class="input-group">
                    <label>내용</label>
                    <textarea id="comm-content" style="height:200px; resize:none;" placeholder="내용을 입력하세요"></textarea>
                    <div id="comm-content-byte" class="byte-counter">0 / 3000</div>
                </div>
                <button id="btn-comm-submit" class="btn primary full-width"
                    onclick="submitCommunityPost()">등록하기</button>
            </div>
        </div>
    </div>

    <!-- C. 갤러리 업로드 -->
    <div id="gallery-write-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('gallery-write-modal')">&times;</span>
            <h3 style="text-align:center; margin-bottom:20px;">📷 사진 올리기</h3>
            <div>
                <div class="input-group">
                    <label>제목</label>
                    <input type="text" id="gallery-title" placeholder="사진 제목">
                    <div id="gallery-title-byte" class="byte-counter">0 / 30</div>
                </div>
                <div class="input-group">
                    <label>사진 선택 (PNG, JPG, JPEG / 5MB 이하)</label>
                    <input type="file" id="gallery-file" accept="image/png, image/jpeg, image/jpg">
                </div>
                <button id="btn-gallery-submit" class="btn primary full-width"
                    onclick="submitGalleryPost()">올리기</button>
            </div>
        </div>
    </div>

    <!-- D. 알림장 글쓰기 -->
    <div id="notice-write-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('notice-write-modal')">&times;</span>
            <h3 style="text-align:center; margin-bottom:20px;">📢 알림 쓰기</h3>
            <div>
                <div class="input-group">
                    <label>제목</label>
                    <input type="text" id="notice-title" placeholder="알림 제목">
                    <div id="notice-title-byte" class="byte-counter">0 / 30</div>
                </div>
                <div class="input-group">
                    <label>내용</label>
                    <textarea id="notice-content" style="height:200px; resize:none;" placeholder="알림 내용"></textarea>
                    <div id="notice-content-byte" class="byte-counter">0 / 3000</div>
                </div>
                <button id="btn-notice-submit" class="btn primary full-width" onclick="submitNoticePost()">등록하기</button>
            </div>
        </div>
    </div>

    <!-- E. 이미지 뷰어 -->
    <div id="image-viewer-modal" class="modal">
        <div class="modal-content large-viewer">
            <div class="large-viewer-close-btn" onclick="closeModal('image-viewer-modal')">&times;</div>
            <div class="large-viewer-body">
                <img id="viewer-img" src="" alt="Full Size">
            </div>
        </div>
    </div>

    <!-- F. 글 상세 보기 -->
    <div id="post-detail-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('post-detail-modal')">&times;</span>
            <h3 id="detail-title" style="margin-bottom:10px; font-size:1.3rem;">제목</h3>
            <div id="detail-meta" style="font-size:0.9rem; color:#888; margin-bottom:20px; text-align:right;"></div>
            <div id="detail-body"
                style="white-space:pre-wrap; min-height:100px; line-height:1.6; font-size:1rem; border-top:1px solid #eee; padding-top:20px;">
                내용
            </div>
        </div>
    </div>

</body>

</html>